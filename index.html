<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/javascript" src="cardGame.js"></script>
  <link rel="stylesheet" href="cardGame.css">
  <title>神経衰弱</title>
</head>

<body>
<button class="start" onclick="gamestart()" >GAME START</button>
  <div class="in-frame" id="frame">

    <div class="card" id="Fr1" onclick="turnCards('back1','Fr1')" ><div class="card back" id="back1"></div></div>
    <div class="card" id="Fr2" onclick="turnCards('back2','Fr2')" ><div class="card back" id="back2"></div></div>
    <div class="card" id="Fr3" onclick="turnCards('back3','Fr3')" ><div class="card back" id="back3"></div></div>
    <div class="card" id="Fr4" onclick="turnCards('back4','Fr4')" ><div class="card back" id="back4"></div></div>
    <div class="card" id="Fr5" onclick="turnCards('back5','Fr5')" ><div class="card back" id="back5"></div></div>
    <div class="card" id="Fr6" onclick="turnCards('back6','Fr6')" ><div class="card back" id="back6"></div></div>
    <div class="card" id="Fr7" onclick="turnCards('back7','Fr7')" ><div class="card back" id="back7"></div></div>
    <div class="card" id="Fr8" onclick="turnCards('back8','Fr8')" ><div class="card back" id="back8"></div></div>
    <div class="card" id="Fr9" onclick="turnCards('back9','Fr9')" ><div class="card back" id="back9"></div></div>
    <div class="card" id="Fr10" onclick="turnCards('back10','Fr10')" ><div class="card back" id="back10"></div></div>

    
  </div>

<script>
const cantTouch = document.getElementById("frame").style;
let flipCard = [];

async function wait(second) {
    return new Promise(resolve => setTimeout(resolve, 1000 * second));
}


function turnCards(BackId,FrId){//クリックしたカードへの処理

  turnCardF = document.getElementById(FrId)//ID取得
  turnCardB = document.getElementById(BackId)//ID取得
  if(turnCardB.style.visibility === "visible"){//対象のビジビリティがビジブル(カードの裏面が表示されているか？)
    turnCardB.style.visibility = "hidden";//裏面を非表示 ＝ カードの表が見えている状態
    flipCard.push( turnCardF );//選択したカードのIDを配列に格納 この後 配列同士で比較する 
    console.log( "turnCardID",turnCardF);
    console.log( "flipCardID",flipCard );
      if (flipCard.length === 2 ){//配列の要素が2つになったら判定処理へ情報飛ばす
        cantTouch.pointerEvents = "none"; 
        cardCheck(flipCard[0],flipCard[1])
        flipCard = [];
      }
      console.log(turnCard.style.visibility);
    }else {
      turnCardB.style.visibility = "visible";//カードの裏面を表示
      // console.log(turnCard.style.visibility);
    }
}

function gamestart(){//gemeスタート　１クリック目で動かないバグの回避とキャントカードタッチ 解除
  cantTouch.pointerEvents = "auto"; 
  for (let i = 10; i > 0; i-- ){
    turnCards(`back${i}`);
    turnCard = document.getElementById(`back${i}`);
    turnCard.style.visibility = "visible";

  }
  console.log("GAME START!")
}

function cardCheck(flip1,flip2){
  let check = []

  cardId1 = flip1.style.backgroundImage;
  check.push (cardId1);
  cardId2 = flip2.style.backgroundImage;
  check.push (cardId2);

  console.log("check:",check);// 判定ロジック　１と２の画像URLを参照し比較
  if(check[0] === check[1]){
    console.log("正解！")//OKだったらどうするか・・・
    cantTouch.pointerEvents = "auto"; 
    check = [];
  }else {
    cantTouch.pointerEvents = "auto"; //NGだったら
    for (let i = 10; i > 0; i-- ){
      turnCards(`back${i}`);
      turnCard = document.getElementById(`back${i}`);
      turnCard.style.visibility = "visible";
      check = [];
    }
  }
}

</script>




</body>

</html>
